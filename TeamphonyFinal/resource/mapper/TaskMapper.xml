<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="teamphony.store.mapper.TaskMapper">

	<!-- <resultMap type="Task" id="taskMap"> </resultMap> -->


	

	<insert id="insertTask" parameterType="task">
		<selectKey resultType="int" keyProperty="taskId" order="BEFORE">
		SELECT task_tb_id_seq.nextval FROM DUAL
		</selectKey>
		insert into task_tb(
			id
			,TITLE
			,CONTENTS
			,DEADLINE
			,FLAG
			,POINT
			)
		values(
			#{taskId}
			,#{title}
			,#{contents, jdbcType=VARCHAR}
			,#{deadline , jdbcType=DATE}
			,#{flag , jdbcType=INTEGER}
			,#{point , jdbcType=INTEGER}
		)
	</insert>
	
	<insert id="insertTaskFile" parameterType="taskFile">
		INSERT INTO 
			TASKFILE_TB(
				SUBMISSIONID
				,FILEPATH
			) 
			VALUES(
				#{submissionId} 
				,#{filePath}
			)
	</insert>
	
	<update id="updateTask" parameterType="task">
			UPDATE TASK_TB
			SET 
				ID						= #{taskId}
				,TITLE                  = #{title}
				,CONTENTS               = #{contents}
				,DEADLINE               = #{deadline , jdbcType=DATE}
				,EVALUATIONPERIOD       = #{evaluationPeriod , jdbcType=DATE}
				,FLAG                   = #{flag , jdbcType=INTEGER}
				,POINT                  = #{point , jdbcType=INTEGER}
			WHERE ID	= #{taskId}
	</update>

	<select id="selectAllTask" resultType="Task">
		select

		id AS taskId
		,TITLE
		,CONTENTS
		,DEADLINE
		,EVALUATIONPERIOD
		,FLAG
		,POINT
		from task_tb
	</select>


	<select id="selectTaskByTaskId" resultType="Task">

		select

		ID AS taskId
		,TITLE
		,CONTENTS
		,DEADLINE
		,EVALUATIONPERIOD
		,FLAG
		,POINT AS point
		from
		task_tb
		where id= #{taskId}

	</select>

	<select id="selectTaskByMemberId" resultType="task">
	</select>




	<delete id="deleteTask" parameterType="int">
		delete
		from task_tb
		where id
		=#{taskId}
	</delete>





</mapper>